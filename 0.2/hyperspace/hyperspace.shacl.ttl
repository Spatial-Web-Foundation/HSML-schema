@prefix space: <https://www.spatialwebfoundation.org/ns/hsml/space#> .
@prefix core: <https://www.spatialwebfoundation.org/ns/hsml/core#> .
@prefix sh: <http://www.w3.org/ns/shacl#> .
@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@prefix schema: <http://schema.org/> .
@prefix xsd: <http://www.w3.org/2001/XMLSchema#> .

# #################################################################
#
#    SHACL Shapes for HSML Hyperspace Module
#
#    This file provides normative shapes for validating instances of
#    the Hyperspace Module as defined in the HSML Implementation
#    Specification (P2874.X/D1, May 2024).
#
# #################################################################

# #################################################################
#    Shape for space:Hyperspace
# #################################################################

space:HyperspaceShape
    a sh:NodeShape ;
    sh:targetClass space:Hyperspace ;
    sh:closed true ;
    sh:ignoredProperties ( rdf:type ) ;
    rdfs:label "Hyperspace Shape" ;
    rdfs:comment "Defines the constraints for a space:Hyperspace instance. It inherits base properties from core:Entity." ;

    # == Inherited properties from core:Entity ==
    sh:property [
        sh:path core:swid ;
        sh:name "swid" ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:datatype xsd:anyURI ;
        sh:message "A Hyperspace must have exactly one core:swid, and its value must be a valid URI."@en ;
    ] ;
    sh:property [
        sh:path schema:name ;
        sh:name "name" ;
        sh:maxCount 1 ;
        sh:datatype xsd:string ;
        sh:message "A Hyperspace can have at most one schema:name, which must be a string."@en ;
    ] ;
    sh:property [
        sh:path schema:description ;
        sh:name "description" ;
        sh:maxCount 1 ;
        sh:datatype xsd:string ;
        sh:message "A Hyperspace can have at most one schema:description, which must be a string."@en ;
    ] ;

    # == Mandatory properties for space:Hyperspace ==
    sh:property [
        sh:path space:hasElementType ;
        sh:name "hasElementType" ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:nodeKind sh:IRI ;
        sh:message "A Hyperspace must have exactly one hasElementType, which must be an IRI referencing a class or datatype."@en ;
    ] ;
    sh:property [
        sh:path space:hasPathType ;
        sh:name "hasPathType" ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:nodeKind sh:IRI ;
        sh:message "A Hyperspace must have exactly one hasPathType, which must be an IRI referencing a class or property."@en ;
    ] ;

    # == Optional property for space:Hyperspace ==
    sh:property [
        sh:path space:hasOperation ;
        sh:name "hasOperation" ;
        sh:class space:Operation ;
        sh:message "Values for hasOperation must be instances of space:Operation."@en ;
    ] .

# #################################################################
#    Shape for space:Operation
# #################################################################

space:OperationShape
    a sh:NodeShape ;
    sh:targetClass space:Operation ;
    sh:closed true ;
    sh:ignoredProperties ( rdf:type ) ;
    rdfs:label "Operation Shape" ;
    rdfs:comment "Defines the constraints for a space:Operation instance. As a core:Entity, it must have a SWID." ;

    # == Inherited properties from core:Entity ==
    sh:property [
        sh:path core:swid ;
        sh:name "swid" ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:datatype xsd:anyURI ;
        sh:message "An Operation must have exactly one core:swid, and its value must be a valid URI."@en ;
    ] ;
    sh:property [
        sh:path schema:name ;
        sh:name "name" ;
        sh:maxCount 1 ;
        sh:datatype xsd:string ;
        sh:message "An Operation can have at most one schema:name, which must be a string."@en ;
    ] ;
    sh:property [
        sh:path schema:description ;
        sh:name "description" ;
        sh:maxCount 1 ;
        sh:datatype xsd:string ;
        sh:message "An Operation can have at most one schema:description, which must be a string."@en ;
    ] .